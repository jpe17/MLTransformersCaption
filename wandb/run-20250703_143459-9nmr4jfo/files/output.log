Using device: mps
Initializing model and data...
/Users/joaoesteves/mli/MLTransformersCaption/08_train_explained_wandb.py:37: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(device == 'cuda' or device == 'mps'))
/Users/joaoesteves/mli/CaptionMe/venv/lib/python3.13/site-packages/torch/amp/grad_scaler.py:136: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
Starting training for 20 epochs with Cross-Attention...

--- Epoch 1/20 ---
  Step 0, Loss: 11.8172
  Step 20, Loss: 4.7281
  Step 40, Loss: 4.2937
  Step 60, Loss: 4.5083
  Step 80, Loss: 4.2419
  Step 100, Loss: 4.2338
  Step 120, Loss: 4.5860
  Step 140, Loss: 3.4512
  Step 160, Loss: 4.3421
  Step 180, Loss: 3.8789
  Step 200, Loss: 2.6915
  Step 220, Loss: 3.7444
  Step 240, Loss: 3.0083
  Step 260, Loss: 3.8305
  Step 280, Loss: 3.4247
  Step 300, Loss: 2.3713
  Step 320, Loss: 2.9484
  Step 340, Loss: 3.8400
  Step 360, Loss: 3.3665
  Step 380, Loss: 2.6830
  Step 400, Loss: 2.8997
  Step 420, Loss: 3.7746
  Step 440, Loss: 2.6528
  Step 460, Loss: 3.6244
  Step 480, Loss: 3.1677
  Step 500, Loss: 3.1045
  Step 520, Loss: 2.9027
  Step 540, Loss: 3.1160
  Step 560, Loss: 3.0922
  Step 580, Loss: 3.4323
  Step 600, Loss: 2.7772
  Step 620, Loss: 3.2734
  Step 640, Loss: 3.1739
  Step 660, Loss: 3.0244
  Step 680, Loss: 2.5427
  Step 700, Loss: 2.4284
  Step 720, Loss: 2.6852
  Step 740, Loss: 3.1283
  Step 760, Loss: 2.8948
  Step 780, Loss: 3.3352
  Step 800, Loss: 2.3463
  Step 820, Loss: 2.9978
  Step 840, Loss: 3.1313
  Step 860, Loss: 3.2049
  Step 880, Loss: 3.1282
  Step 900, Loss: 3.1556
  Step 920, Loss: 2.2737
  Step 940, Loss: 3.0841
  Step 960, Loss: 2.8760
  Step 980, Loss: 2.9218
  Step 1000, Loss: 2.6628
  Step 1020, Loss: 2.1020
  Step 1040, Loss: 2.7820
  Step 1060, Loss: 3.0695
  Step 1080, Loss: 2.6736
  Step 1100, Loss: 1.9448
  Step 1120, Loss: 3.1016
  Step 1140, Loss: 2.9120
  Step 1160, Loss: 3.2063
  Step 1180, Loss: 3.1294
  Step 1200, Loss: 2.5506
  Step 1220, Loss: 1.9035
  Step 1240, Loss: 3.2335
  Step 1260, Loss: 2.9877
  Step 1280, Loss: 2.2919
  Step 1300, Loss: 2.6026
  Step 1320, Loss: 2.7666
  Step 1340, Loss: 3.1526
  Step 1360, Loss: 2.6098
  Step 1380, Loss: 2.7252
  Step 1400, Loss: 3.4811
  Step 1420, Loss: 2.5756
  Step 1440, Loss: 2.5923
  Step 1460, Loss: 3.3012
  Step 1480, Loss: 2.8683
  Step 1500, Loss: 3.2516
  Step 1520, Loss: 3.0794
  Step 1540, Loss: 1.9395
  Step 1560, Loss: 2.6543
  Step 1580, Loss: 2.8584
  Step 1600, Loss: 2.0000
  Step 1620, Loss: 1.9844
  Step 1640, Loss: 2.2036
  Step 1660, Loss: 2.1036
  Step 1680, Loss: 2.4266
  Step 1700, Loss: 2.8803
  Step 1720, Loss: 3.3547
  Step 1740, Loss: 2.9404
  Step 1760, Loss: 2.6476
  Step 1780, Loss: 2.2721
  Step 1800, Loss: 2.8870
  Step 1820, Loss: 2.8963
  Step 1840, Loss: 2.5774
  Step 1860, Loss: 2.6391
  Step 1880, Loss: 2.7379
  Step 1900, Loss: 2.4538
  Step 1920, Loss: 2.6097
  Step 1940, Loss: 2.6433
  Step 1960, Loss: 3.0325
  Step 1980, Loss: 2.6103
  Step 2000, Loss: 2.2845
  Step 2020, Loss: 2.1799

--- Epoch 2/20 ---
  Step 0, Loss: 2.8922
  Step 20, Loss: 2.4091
  Step 40, Loss: 2.2964
  Step 60, Loss: 2.8027
  Step 80, Loss: 2.5298
  Step 100, Loss: 2.5897
  Step 120, Loss: 3.1230
  Step 140, Loss: 2.4465
  Step 160, Loss: 2.9816
  Step 180, Loss: 2.8896
  Step 200, Loss: 2.0428
  Step 220, Loss: 2.7542
  Step 240, Loss: 2.2751
  Step 260, Loss: 2.7697
  Step 280, Loss: 2.7725
  Step 300, Loss: 1.8437
  Step 320, Loss: 2.2864
  Step 340, Loss: 3.0604
  Step 360, Loss: 2.6865
  Step 380, Loss: 2.2527
  Step 400, Loss: 2.3413
  Step 420, Loss: 3.1487
  Step 440, Loss: 2.1095
  Step 460, Loss: 3.0330
  Step 480, Loss: 2.6557
  Step 500, Loss: 2.6258
  Step 520, Loss: 2.4167
  Step 540, Loss: 2.5465
  Step 560, Loss: 2.4749
  Step 580, Loss: 2.8271
  Step 600, Loss: 2.3328
  Step 620, Loss: 2.7180
  Step 640, Loss: 2.5111
  Step 660, Loss: 2.6271
  Step 680, Loss: 2.1640
  Step 700, Loss: 2.0535
  Step 720, Loss: 2.2392
  Step 740, Loss: 2.5777
  Step 760, Loss: 2.4732
  Step 780, Loss: 2.8555
  Step 800, Loss: 1.9823
  Step 820, Loss: 2.4919
  Step 840, Loss: 2.6425
  Step 860, Loss: 2.7924
  Step 880, Loss: 2.5961
  Step 900, Loss: 2.6795
  Step 920, Loss: 1.8714
  Step 940, Loss: 2.5673
  Step 960, Loss: 2.3814
  Step 980, Loss: 2.4649
  Step 1000, Loss: 2.3288
  Step 1020, Loss: 1.8798
  Step 1040, Loss: 2.3270
  Step 1060, Loss: 2.6607
  Step 1080, Loss: 2.1712
  Step 1100, Loss: 1.6083
  Step 1120, Loss: 2.6588
  Step 1140, Loss: 2.5497
  Step 1160, Loss: 2.7061
  Step 1180, Loss: 2.7191
  Step 1200, Loss: 2.1675
  Step 1220, Loss: 1.4965
  Step 1240, Loss: 2.6995
  Step 1260, Loss: 2.6546
  Step 1280, Loss: 1.9473
  Step 1300, Loss: 2.2956
  Step 1320, Loss: 2.3726
  Step 1340, Loss: 2.8293
  Step 1360, Loss: 2.3109
  Step 1380, Loss: 2.3256
  Step 1400, Loss: 3.1690
  Step 1420, Loss: 2.2131
  Step 1440, Loss: 2.2208
  Step 1460, Loss: 2.9437
  Step 1480, Loss: 2.4484
  Step 1500, Loss: 2.9905
  Step 1520, Loss: 2.7978
  Step 1540, Loss: 1.6976
  Step 1560, Loss: 2.2923
  Step 1580, Loss: 2.5666
  Step 1600, Loss: 1.8220
  Step 1620, Loss: 1.7550
  Step 1640, Loss: 1.9772
  Step 1660, Loss: 1.7961
  Step 1680, Loss: 2.1353
  Step 1700, Loss: 2.5543
  Step 1720, Loss: 3.0183
  Step 1740, Loss: 2.6689
  Step 1760, Loss: 2.2703
  Step 1780, Loss: 1.9965
  Step 1800, Loss: 2.5120
  Step 1820, Loss: 2.5896
  Step 1840, Loss: 2.2980
  Step 1860, Loss: 2.4217
  Step 1880, Loss: 2.4302
  Step 1900, Loss: 2.2061
  Step 1920, Loss: 2.3342
  Step 1940, Loss: 2.2932
  Step 1960, Loss: 2.7311
  Step 1980, Loss: 2.2795
  Step 2000, Loss: 2.0519
  Step 2020, Loss: 1.9808

--- Epoch 3/20 ---
  Step 0, Loss: 2.6159
  Step 20, Loss: 2.1845
  Step 40, Loss: 2.0400
  Step 60, Loss: 2.5979
  Step 80, Loss: 2.2694
  Step 100, Loss: 2.2295
  Step 120, Loss: 2.7815
  Step 140, Loss: 2.2342
  Step 160, Loss: 2.6772
  Step 180, Loss: 2.6631
  Step 200, Loss: 1.7448
  Step 220, Loss: 2.4638
  Step 240, Loss: 2.1396
  Step 260, Loss: 2.4251
  Step 280, Loss: 2.5888
  Step 300, Loss: 1.6990
  Step 320, Loss: 2.0328
  Step 340, Loss: 2.7645
  Step 360, Loss: 2.4768
  Step 380, Loss: 2.0947
  Step 400, Loss: 2.1029
  Step 420, Loss: 2.9299
  Step 440, Loss: 1.9099
  Step 460, Loss: 2.8465
  Step 480, Loss: 2.4503
  Step 500, Loss: 2.4168
  Step 520, Loss: 2.2294
  Step 540, Loss: 2.3196
  Step 560, Loss: 2.2652
  Step 580, Loss: 2.6068
  Step 600, Loss: 2.1508
  Step 620, Loss: 2.5540
  Step 640, Loss: 2.3261
  Step 660, Loss: 2.4368
  Step 680, Loss: 2.0539
  Step 700, Loss: 1.9617
  Step 720, Loss: 2.0857
  Step 740, Loss: 2.3782
  Step 760, Loss: 2.3119
  Step 780, Loss: 2.6925
  Step 800, Loss: 1.8511
  Step 820, Loss: 2.2998
  Step 840, Loss: 2.4202
  Step 860, Loss: 2.5740
  Step 880, Loss: 2.3874
  Step 900, Loss: 2.4607
  Step 920, Loss: 1.6710
  Step 940, Loss: 2.4239
  Step 960, Loss: 2.1985
  Step 980, Loss: 2.3235
  Step 1000, Loss: 2.1999
  Step 1020, Loss: 1.8041
  Step 1040, Loss: 2.3317
  Step 1060, Loss: 2.4643
  Step 1080, Loss: 2.0970
  Step 1100, Loss: 1.5150
  Step 1120, Loss: 2.4642
  Step 1140, Loss: 2.2788
  Step 1160, Loss: 2.5346
  Step 1180, Loss: 2.5492
  Step 1200, Loss: 2.0036
  Step 1220, Loss: 1.3543
  Step 1240, Loss: 2.5817
  Step 1260, Loss: 2.4721
  Step 1280, Loss: 1.8232
  Step 1300, Loss: 2.1634
  Step 1320, Loss: 2.1782
  Step 1340, Loss: 2.6514
  Step 1360, Loss: 2.1950
  Step 1380, Loss: 2.1498
  Step 1400, Loss: 3.0564
  Step 1420, Loss: 2.0681
  Step 1440, Loss: 2.0818
  Step 1460, Loss: 2.8081
  Step 1480, Loss: 2.3513
  Step 1500, Loss: 2.8432
  Step 1520, Loss: 2.5837
  Step 1540, Loss: 1.5795
  Step 1560, Loss: 2.1960
  Step 1580, Loss: 2.3650
  Step 1600, Loss: 1.7500
  Step 1620, Loss: 1.6404
  Step 1640, Loss: 1.8865
  Step 1660, Loss: 1.7614
  Step 1680, Loss: 2.0611
  Step 1700, Loss: 2.3962
  Step 1720, Loss: 2.8775
  Step 1740, Loss: 2.5766
  Step 1760, Loss: 2.0941
  Step 1780, Loss: 1.8640
  Step 1800, Loss: 2.3342
  Step 1820, Loss: 2.4574
  Step 1840, Loss: 2.1597
  Step 1860, Loss: 2.2803
  Step 1880, Loss: 2.2457
  Step 1900, Loss: 2.0283
  Step 1920, Loss: 2.1848
  Step 1940, Loss: 2.1357
  Step 1960, Loss: 2.5981
  Step 1980, Loss: 2.1314
  Step 2000, Loss: 1.9710
  Step 2020, Loss: 1.8821

--- Epoch 4/20 ---
  Step 0, Loss: 2.4481
  Step 20, Loss: 2.0751
  Step 40, Loss: 1.8838
  Step 60, Loss: 2.4646
  Step 80, Loss: 2.1654
  Step 100, Loss: 2.0387
  Step 120, Loss: 2.5900
  Step 140, Loss: 2.1469
  Step 160, Loss: 2.5331
  Step 180, Loss: 2.5228
  Step 200, Loss: 1.6635
  Step 220, Loss: 2.3017
  Step 240, Loss: 2.0536
  Step 260, Loss: 2.2880
  Step 280, Loss: 2.5111
  Step 300, Loss: 1.6439
  Step 320, Loss: 1.8944
  Step 340, Loss: 2.6059
  Step 360, Loss: 2.3628
  Step 380, Loss: 1.9976
  Step 400, Loss: 1.9899
  Step 420, Loss: 2.8279
  Step 440, Loss: 1.8013
  Step 460, Loss: 2.7448
  Step 480, Loss: 2.3607
  Step 500, Loss: 2.2961
  Step 520, Loss: 2.1320
  Step 540, Loss: 2.2114
  Step 560, Loss: 2.1337
  Step 580, Loss: 2.4367
  Step 600, Loss: 2.0246
  Step 620, Loss: 2.4554
  Step 640, Loss: 2.2100
  Step 660, Loss: 2.3476
  Step 680, Loss: 1.9881
  Step 700, Loss: 1.8216
  Step 720, Loss: 1.9992
  Step 740, Loss: 2.2404
  Step 760, Loss: 2.1961
  Step 780, Loss: 2.5940
  Step 800, Loss: 1.7382
  Step 820, Loss: 2.1859
  Step 840, Loss: 2.2775
  Step 860, Loss: 2.4819
  Step 880, Loss: 2.2952
  Step 900, Loss: 2.3445
  Step 920, Loss: 1.5710
  Step 940, Loss: 2.3195
  Step 960, Loss: 2.0846
  Step 980, Loss: 2.2180
  Step 1000, Loss: 2.1072
  Step 1020, Loss: 1.6983
  Step 1040, Loss: 2.0272
  Step 1060, Loss: 2.3461
  Step 1080, Loss: 1.9480
  Step 1100, Loss: 1.4949
  Step 1120, Loss: 2.3482
  Step 1140, Loss: 2.1499
  Step 1160, Loss: 2.4163
  Step 1180, Loss: 2.5250
  Step 1200, Loss: 1.9035
  Step 1220, Loss: 1.2714
  Step 1240, Loss: 2.4393
  Step 1260, Loss: 2.3361
  Step 1280, Loss: 1.7274
  Step 1300, Loss: 2.0699
  Step 1320, Loss: 2.0686
  Step 1340, Loss: 2.5226
  Step 1360, Loss: 2.1433
  Step 1380, Loss: 2.0443
  Step 1400, Loss: 3.0044
  Step 1420, Loss: 1.9671
  Step 1440, Loss: 2.0247
  Step 1460, Loss: 2.6755
  Step 1480, Loss: 2.2405
  Step 1500, Loss: 2.7407
  Step 1520, Loss: 2.4854
  Step 1540, Loss: 1.5062
  Step 1560, Loss: 2.1365
  Step 1580, Loss: 2.2382
  Step 1600, Loss: 1.6979
  Step 1620, Loss: 1.5844
  Step 1640, Loss: 1.8074
  Step 1660, Loss: 1.6397
  Step 1680, Loss: 1.9557
  Step 1700, Loss: 2.3381
  Step 1720, Loss: 2.7726
  Step 1740, Loss: 2.4964
  Step 1760, Loss: 1.9995
  Step 1780, Loss: 1.7547
  Step 1800, Loss: 2.2547
  Step 1820, Loss: 2.3761
  Step 1840, Loss: 2.0664
  Step 1860, Loss: 2.1946
  Step 1880, Loss: 2.0968
  Step 1900, Loss: 1.9466
  Step 1920, Loss: 2.1053
  Step 1940, Loss: 2.0234
  Step 1960, Loss: 2.5036
  Step 1980, Loss: 2.0517
  Step 2000, Loss: 1.9094
  Step 2020, Loss: 1.7962

--- Epoch 5/20 ---
  Step 0, Loss: 2.3576
  Step 20, Loss: 1.9818
  Step 40, Loss: 1.7616
  Step 60, Loss: 2.4038
  Step 80, Loss: 2.0688
  Step 100, Loss: 1.9333
  Step 120, Loss: 2.5216
  Step 140, Loss: 2.0686
  Step 160, Loss: 2.4252
  Step 180, Loss: 2.3900
  Step 200, Loss: 1.5724
  Step 220, Loss: 2.2774
  Step 240, Loss: 1.9722
  Step 260, Loss: 2.1895
  Step 280, Loss: 2.4534
  Step 300, Loss: 1.6232
  Step 320, Loss: 1.8379
  Step 340, Loss: 2.4699
  Step 360, Loss: 2.2612
  Step 380, Loss: 1.9361
  Step 400, Loss: 1.9298
  Step 420, Loss: 2.6728
  Step 440, Loss: 1.7222
  Step 460, Loss: 2.6235
  Step 480, Loss: 2.2853
  Step 500, Loss: 2.2056
  Step 520, Loss: 2.0484
  Step 540, Loss: 2.1500
  Step 560, Loss: 1.9953
  Step 580, Loss: 2.3238
  Step 600, Loss: 1.9386
  Step 620, Loss: 2.3652
  Step 640, Loss: 2.1170
  Step 660, Loss: 2.2345
  Step 680, Loss: 1.9301
  Step 700, Loss: 1.7298
  Step 720, Loss: 1.9115
  Step 740, Loss: 2.2353
  Step 760, Loss: 2.2265
  Step 780, Loss: 2.4719
  Step 800, Loss: 1.6930
  Step 820, Loss: 2.0555
  Step 840, Loss: 2.1468
  Step 860, Loss: 2.3883
  Step 880, Loss: 2.2539
  Step 900, Loss: 2.2527
  Step 920, Loss: 1.4583
  Step 940, Loss: 2.2710
  Step 960, Loss: 1.9887
  Step 980, Loss: 2.1423
  Step 1000, Loss: 2.0256
  Step 1020, Loss: 1.6268
  Step 1040, Loss: 1.9894
  Step 1060, Loss: 2.2353
  Step 1080, Loss: 1.8443
  Step 1100, Loss: 1.4414
  Step 1120, Loss: 2.2750
  Step 1140, Loss: 2.0767
  Step 1160, Loss: 2.3164
  Step 1180, Loss: 2.3765
  Step 1200, Loss: 1.8135
  Step 1220, Loss: 1.2350
  Step 1240, Loss: 2.3406
  Step 1260, Loss: 2.2633
  Step 1280, Loss: 1.6656
  Step 1300, Loss: 1.9774
  Step 1320, Loss: 1.9817
  Step 1340, Loss: 2.4036
  Step 1360, Loss: 2.0260
  Step 1380, Loss: 1.9909
  Step 1400, Loss: 2.8715
  Step 1420, Loss: 1.9171
  Step 1440, Loss: 1.9233
  Step 1460, Loss: 2.5700
  Step 1480, Loss: 2.1582
  Step 1500, Loss: 2.6286
  Step 1520, Loss: 2.3125
  Step 1540, Loss: 1.4619
  Step 1560, Loss: 2.0259
  Step 1580, Loss: 2.1444
  Step 1600, Loss: 1.6289
  Step 1620, Loss: 1.5277
  Step 1640, Loss: 1.7416
  Step 1660, Loss: 1.5816
  Step 1680, Loss: 1.8650
  Step 1700, Loss: 2.2581
  Step 1720, Loss: 2.7079
  Step 1740, Loss: 2.4416
  Step 1760, Loss: 1.9272
  Step 1780, Loss: 1.6848
  Step 1800, Loss: 2.1156
  Step 1820, Loss: 2.3111
  Step 1840, Loss: 2.0548
  Step 1860, Loss: 2.1223
  Step 1880, Loss: 2.0106
  Step 1900, Loss: 1.8630
  Step 1920, Loss: 2.0045
  Step 1940, Loss: 1.9811
  Step 1960, Loss: 2.4129
  Step 1980, Loss: 1.9930
  Step 2000, Loss: 1.8513
  Step 2020, Loss: 1.7284

--- Epoch 6/20 ---
  Step 0, Loss: 2.2592
  Step 20, Loss: 1.9157
  Step 40, Loss: 1.6501
  Step 60, Loss: 2.3567
  Step 80, Loss: 1.9753
  Step 100, Loss: 1.8655
  Step 120, Loss: 2.4593
  Step 140, Loss: 2.0122
  Step 160, Loss: 2.3325
  Step 180, Loss: 2.3026
  Step 200, Loss: 1.5243
  Step 220, Loss: 2.2166
  Step 240, Loss: 1.9216
  Step 260, Loss: 2.1173
  Step 280, Loss: 2.3836
  Step 300, Loss: 1.5465
  Step 320, Loss: 1.7773
  Step 340, Loss: 2.3867
  Step 360, Loss: 2.2873
  Step 380, Loss: 1.8714
  Step 400, Loss: 1.8640
  Step 420, Loss: 2.5441
  Step 440, Loss: 1.6388
  Step 460, Loss: 2.5291
  Step 480, Loss: 2.2201
  Step 500, Loss: 2.1249
  Step 520, Loss: 1.9724
  Step 540, Loss: 2.0676
  Step 560, Loss: 1.9020
  Step 580, Loss: 2.3106
  Step 600, Loss: 1.8567
  Step 620, Loss: 2.2774
  Step 640, Loss: 2.0209
  Step 660, Loss: 2.1584
  Step 680, Loss: 1.8855
  Step 700, Loss: 1.6487
  Step 720, Loss: 1.8831
  Step 740, Loss: 2.1100
  Step 760, Loss: 2.1467
  Step 780, Loss: 2.3702
  Step 800, Loss: 1.6240
  Step 820, Loss: 1.9440
  Step 840, Loss: 2.1061
  Step 860, Loss: 2.2653
  Step 880, Loss: 2.1919
  Step 900, Loss: 2.1900
  Step 920, Loss: 1.3978
  Step 940, Loss: 2.1756
  Step 960, Loss: 1.9008
  Step 980, Loss: 2.0471
  Step 1000, Loss: 2.0049
  Step 1020, Loss: 1.5952
  Step 1040, Loss: 1.8776
  Step 1060, Loss: 2.1205
  Step 1080, Loss: 1.7431
  Step 1100, Loss: 1.3572
  Step 1120, Loss: 2.1593
  Step 1140, Loss: 1.9579
  Step 1160, Loss: 2.2258
  Step 1180, Loss: 2.2766
  Step 1200, Loss: 1.7461
  Step 1220, Loss: 1.2414
  Step 1240, Loss: 2.2667
  Step 1260, Loss: 2.1929
  Step 1280, Loss: 1.6069
  Step 1300, Loss: 1.8948
  Step 1320, Loss: 1.9505
  Step 1340, Loss: 2.2916
  Step 1360, Loss: 1.9511
  Step 1380, Loss: 1.9011
  Step 1400, Loss: 2.7869
  Step 1420, Loss: 1.9354
  Step 1440, Loss: 1.9468
  Step 1460, Loss: 2.4770
  Step 1480, Loss: 2.0766
  Step 1500, Loss: 2.5538
  Step 1520, Loss: 2.1877
  Step 1540, Loss: 1.4235
  Step 1560, Loss: 1.9360
  Step 1580, Loss: 2.0725
  Step 1600, Loss: 1.5653
  Step 1620, Loss: 1.4762
  Step 1640, Loss: 1.7134
  Step 1660, Loss: 1.5648
  Step 1680, Loss: 1.7808
  Step 1700, Loss: 2.1723
  Step 1720, Loss: 2.6248
  Step 1740, Loss: 2.4311
  Step 1760, Loss: 1.8493
  Step 1780, Loss: 1.6030
  Step 1800, Loss: 2.0060
  Step 1820, Loss: 2.2061
  Step 1840, Loss: 1.9687
  Step 1860, Loss: 2.0408
  Step 1880, Loss: 1.9180
  Step 1900, Loss: 1.7661
  Step 1920, Loss: 1.9149
  Step 1940, Loss: 1.8647
  Step 1960, Loss: 2.3167
  Step 1980, Loss: 1.9189
  Step 2000, Loss: 1.7917
  Step 2020, Loss: 1.6390

--- Epoch 7/20 ---
  Step 0, Loss: 2.1644
  Step 20, Loss: 1.8738
  Step 40, Loss: 1.5585
  Step 60, Loss: 2.2587
  Step 80, Loss: 1.8840
  Step 100, Loss: 1.7538
  Step 120, Loss: 2.3655
  Step 140, Loss: 1.9500
  Step 160, Loss: 2.3160
  Step 180, Loss: 2.2300
  Step 200, Loss: 1.4721
  Step 220, Loss: 2.1479
  Step 240, Loss: 1.8597
  Step 260, Loss: 2.0618
  Step 280, Loss: 2.2954
  Step 300, Loss: 1.4945
  Step 320, Loss: 1.7232
  Step 340, Loss: 2.3012
  Step 360, Loss: 2.1515
  Step 380, Loss: 1.8339
  Step 400, Loss: 1.8055
  Step 420, Loss: 2.4300
  Step 440, Loss: 1.5751
  Step 460, Loss: 2.4242
  Step 480, Loss: 2.1504
  Step 500, Loss: 2.0604
  Step 520, Loss: 1.9186
  Step 540, Loss: 1.9787
  Step 560, Loss: 1.8606
  Step 580, Loss: 2.2066
  Step 600, Loss: 1.7954
  Step 620, Loss: 2.1879
  Step 640, Loss: 2.0048
  Step 660, Loss: 2.0816
  Step 680, Loss: 1.8225
  Step 700, Loss: 1.5640
  Step 720, Loss: 1.7894
  Step 740, Loss: 2.0233
  Step 760, Loss: 2.0922
  Step 780, Loss: 2.3097
  Step 800, Loss: 1.5349
  Step 820, Loss: 1.8385
  Step 840, Loss: 1.9788
  Step 860, Loss: 2.1941
  Step 880, Loss: 2.1414
  Step 900, Loss: 2.0912
  Step 920, Loss: 1.3730
  Step 940, Loss: 2.0796
  Step 960, Loss: 1.8059
  Step 980, Loss: 1.9917
  Step 1000, Loss: 1.9127
  Step 1020, Loss: 1.5326
  Step 1040, Loss: 1.8186
  Step 1060, Loss: 2.0104
  Step 1080, Loss: 1.6717
  Step 1100, Loss: 1.2876
  Step 1120, Loss: 2.0855
  Step 1140, Loss: 1.8655
  Step 1160, Loss: 2.1088
  Step 1180, Loss: 2.1405
  Step 1200, Loss: 1.6710
  Step 1220, Loss: 1.1851
  Step 1240, Loss: 2.1955
  Step 1260, Loss: 2.0981
  Step 1280, Loss: 1.5044
  Step 1300, Loss: 1.8357
  Step 1320, Loss: 1.9024
  Step 1340, Loss: 2.1739
  Step 1360, Loss: 1.8587
  Step 1380, Loss: 1.9523
  Step 1400, Loss: 2.7336
  Step 1420, Loss: 1.8342
  Step 1440, Loss: 1.8177
  Step 1460, Loss: 2.3546
  Step 1480, Loss: 1.9918
  Step 1500, Loss: 2.4685
  Step 1520, Loss: 2.1091
  Step 1540, Loss: 1.3913
  Step 1560, Loss: 1.8790
  Step 1580, Loss: 2.0477
  Step 1600, Loss: 1.5122
  Step 1620, Loss: 1.4145
  Step 1640, Loss: 1.6848
  Step 1660, Loss: 1.5020
  Step 1680, Loss: 1.6894
  Step 1700, Loss: 2.0548
  Step 1720, Loss: 2.5234
  Step 1740, Loss: 2.3323
  Step 1760, Loss: 1.7614
  Step 1780, Loss: 1.5349
  Step 1800, Loss: 1.9188
  Step 1820, Loss: 2.1154
  Step 1840, Loss: 1.8645
  Step 1860, Loss: 1.9537
  Step 1880, Loss: 1.8533
  Step 1900, Loss: 1.6939
  Step 1920, Loss: 1.9128
  Step 1940, Loss: 1.8187
  Step 1960, Loss: 2.2320
  Step 1980, Loss: 1.8637
  Step 2000, Loss: 1.7185
  Step 2020, Loss: 1.5832

--- Epoch 8/20 ---
  Step 0, Loss: 2.0843
  Step 20, Loss: 1.7854
  Step 40, Loss: 1.4911
  Step 60, Loss: 2.1829
  Step 80, Loss: 1.8428
  Step 100, Loss: 1.6493
  Step 120, Loss: 2.2800
  Step 140, Loss: 1.8684
  Step 160, Loss: 2.1993
  Step 180, Loss: 2.1097
  Step 200, Loss: 1.4038
  Step 220, Loss: 2.0599
  Step 240, Loss: 1.7919
  Step 260, Loss: 1.9558
  Step 280, Loss: 2.2335
  Step 300, Loss: 1.4215
  Step 320, Loss: 1.6548
  Step 340, Loss: 2.3033
  Step 360, Loss: 2.0500
  Step 380, Loss: 1.8503
  Step 400, Loss: 1.7393
  Step 420, Loss: 2.3273
  Step 440, Loss: 1.5117
  Step 460, Loss: 2.2957
  Step 480, Loss: 2.0883
  Step 500, Loss: 2.0102
  Step 520, Loss: 1.8471
  Step 540, Loss: 1.9091
  Step 560, Loss: 1.7623
  Step 580, Loss: 2.1044
  Step 600, Loss: 1.7123
  Step 620, Loss: 2.1531
  Step 640, Loss: 1.9369
  Step 660, Loss: 1.9923
  Step 680, Loss: 1.7350
  Step 700, Loss: 1.4962
  Step 720, Loss: 1.7173
  Step 740, Loss: 2.1009
  Step 760, Loss: 2.1272
  Step 780, Loss: 2.2486
  Step 800, Loss: 1.4720
  Step 820, Loss: 1.7759
  Step 840, Loss: 1.9022
  Step 860, Loss: 2.0877
  Step 880, Loss: 2.0626
  Step 900, Loss: 2.0184
  Step 920, Loss: 1.3543
  Step 940, Loss: 2.0009
  Step 960, Loss: 1.7012
  Step 980, Loss: 1.9140
  Step 1000, Loss: 1.8228
  Step 1020, Loss: 1.4604
  Step 1040, Loss: 1.7535
  Step 1060, Loss: 1.9271
  Step 1080, Loss: 1.5654
  Step 1100, Loss: 1.2589
  Step 1120, Loss: 2.0212
  Step 1140, Loss: 1.7713
  Step 1160, Loss: 2.0061
  Step 1180, Loss: 2.0606
  Step 1200, Loss: 1.6023
  Step 1220, Loss: 1.1184
  Step 1240, Loss: 2.0862
  Step 1260, Loss: 2.0498
  Step 1280, Loss: 1.4178
  Step 1300, Loss: 1.7846
  Step 1320, Loss: 1.7722
  Step 1340, Loss: 2.0483
  Step 1360, Loss: 1.7635
  Step 1380, Loss: 1.8120
  Step 1400, Loss: 2.6001
  Step 1420, Loss: 1.7451
  Step 1440, Loss: 1.7005
  Step 1460, Loss: 2.2201
  Step 1480, Loss: 1.9630
  Step 1500, Loss: 2.3670
  Step 1520, Loss: 2.0206
  Step 1540, Loss: 1.3373
  Step 1560, Loss: 1.7979
  Step 1580, Loss: 1.9997
  Step 1600, Loss: 1.4519
  Step 1620, Loss: 1.3434
  Step 1640, Loss: 1.6442
  Step 1660, Loss: 1.4600
  Step 1680, Loss: 1.6338
  Step 1700, Loss: 1.9555
  Step 1720, Loss: 2.4407
  Step 1740, Loss: 2.2296
  Step 1760, Loss: 1.7006
  Step 1780, Loss: 1.4736
  Step 1800, Loss: 1.8312
  Step 1820, Loss: 2.0015
  Step 1840, Loss: 1.7768
  Step 1860, Loss: 1.8481
  Step 1880, Loss: 1.7475
  Step 1900, Loss: 1.5780
  Step 1920, Loss: 1.8675
  Step 1940, Loss: 1.7527
  Step 1960, Loss: 2.1571
  Step 1980, Loss: 1.8229
  Step 2000, Loss: 1.6546
  Step 2020, Loss: 1.5104

--- Epoch 9/20 ---
  Step 0, Loss: 2.1277
  Step 20, Loss: 1.7033
  Step 40, Loss: 1.3807
  Step 60, Loss: 2.0867
  Step 80, Loss: 1.7897
  Step 100, Loss: 1.5657
  Step 120, Loss: 2.2699
  Step 140, Loss: 1.8029
  Step 160, Loss: 2.1967
  Step 180, Loss: 2.0637
  Step 200, Loss: 1.3234
  Step 220, Loss: 1.9959
  Step 240, Loss: 1.7382
  Step 260, Loss: 1.8634
  Step 280, Loss: 2.1819
  Step 300, Loss: 1.3308
  Step 320, Loss: 1.5971
  Step 340, Loss: 2.2622
  Step 360, Loss: 1.9514
  Step 380, Loss: 1.7781
  Step 400, Loss: 1.7044
  Step 420, Loss: 2.1560
  Step 440, Loss: 1.4492
  Step 460, Loss: 2.2329
  Step 480, Loss: 2.0506
  Step 500, Loss: 1.9429
  Step 520, Loss: 1.7614
  Step 540, Loss: 1.8724
  Step 560, Loss: 1.6519
  Step 580, Loss: 1.9956
  Step 600, Loss: 1.6378
  Step 620, Loss: 2.2185
  Step 640, Loss: 1.8423
  Step 660, Loss: 1.9301
  Step 680, Loss: 1.6882
  Step 700, Loss: 1.4411
  Step 720, Loss: 1.6450
  Step 740, Loss: 2.0386
  Step 760, Loss: 2.0270
  Step 780, Loss: 2.1616
  Step 800, Loss: 1.4417
  Step 820, Loss: 1.6828
  Step 840, Loss: 1.7314
  Step 860, Loss: 1.9817
  Step 880, Loss: 2.0135
  Step 900, Loss: 1.9367
  Step 920, Loss: 1.3077
  Step 940, Loss: 1.9092
  Step 960, Loss: 1.5936
  Step 980, Loss: 1.8308
  Step 1000, Loss: 1.7457
  Step 1020, Loss: 1.4246
  Step 1040, Loss: 1.6798
  Step 1060, Loss: 1.8758
  Step 1080, Loss: 1.4821
  Step 1100, Loss: 1.2329
  Step 1120, Loss: 1.9938
  Step 1140, Loss: 1.6574
  Step 1160, Loss: 1.9128
  Step 1180, Loss: 1.9888
  Step 1200, Loss: 1.5061
  Step 1220, Loss: 1.0515
  Step 1240, Loss: 2.0863
  Step 1260, Loss: 2.0249
  Step 1280, Loss: 1.3502
  Step 1300, Loss: 1.7074
  Step 1320, Loss: 1.7147
  Step 1340, Loss: 1.9283
  Step 1360, Loss: 1.6476
  Step 1380, Loss: 1.7178
  Step 1400, Loss: 2.5208
  Step 1420, Loss: 1.6530
  Step 1440, Loss: 1.6600
  Step 1460, Loss: 2.1333
  Step 1480, Loss: 1.9823
  Step 1500, Loss: 2.2360
  Step 1520, Loss: 1.9102
  Step 1540, Loss: 1.2707
  Step 1560, Loss: 1.7729
  Step 1580, Loss: 1.9351
  Step 1600, Loss: 1.4474
  Step 1620, Loss: 1.2810
  Step 1640, Loss: 1.5642
  Step 1660, Loss: 1.4203
  Step 1680, Loss: 1.5598
  Step 1700, Loss: 1.9473
  Step 1720, Loss: 2.3238
  Step 1740, Loss: 2.1546
  Step 1760, Loss: 1.6286
  Step 1780, Loss: 1.4137
  Step 1800, Loss: 1.8373
  Step 1820, Loss: 1.9014
  Step 1840, Loss: 1.7114
  Step 1860, Loss: 1.7860
  Step 1880, Loss: 1.6840
  Step 1900, Loss: 1.5005
  Step 1920, Loss: 1.7612
  Step 1940, Loss: 1.6715
  Step 1960, Loss: 2.0927
  Step 1980, Loss: 1.8234
  Step 2000, Loss: 1.5878
  Step 2020, Loss: 1.4167

--- Epoch 10/20 ---
  Step 0, Loss: 2.0512
  Step 20, Loss: 1.6288
  Step 40, Loss: 1.2848
  Step 60, Loss: 2.0578
  Step 80, Loss: 1.6965
  Step 100, Loss: 1.4586
  Step 120, Loss: 2.2266
  Step 140, Loss: 1.8332
  Step 160, Loss: 2.1351
  Step 180, Loss: 2.0032
  Step 200, Loss: 1.2370
